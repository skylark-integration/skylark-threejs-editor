{"version":3,"sources":["sideitems/Script.js"],"names":["define","mrdoobui","AddScriptCommand","SetScriptValueCommand","RemoveScriptCommand","SidebarScript","editor","strings","signals","container","UIPanel","setDisplay","add","UIText","getKey","setTextTransform","UIBreak","scriptsContainer","UIRow","newScript","UIButton","update","clear","object","selected","scripts","uuid","undefined","length","i","script","name","UIInput","setWidth","setFontSize","onChange","execute","this","getValue","edit","setMarginLeft","onClick","editScript","dispatch","remove","confirm","source","objectSelected","camera","scriptAdded","scriptRemoved","scriptChanged"],"mappings":";;;;;;;AAAAA,QACI,mBACA,+BACA,oCACA,mCACD,SAAUC,EAAUC,EAAkBC,EAAuBC,GAC5D,aAqEA,OAASC,cApEW,SAAUC,GAC1B,IAAIC,EAAUD,EAAOC,QACjBC,EAAUF,EAAOE,QACjBC,EAAY,IAAIR,EAASS,QAC7BD,EAAUE,WAAW,QACrBF,EAAUG,IAAI,IAAIX,EAASY,OAAON,EAAQO,OAAO,mBAAmBC,iBAAiB,cACrFN,EAAUG,IAAI,IAAIX,EAASe,SAC3BP,EAAUG,IAAI,IAAIX,EAASe,SAC3B,IAAIC,EAAmB,IAAIhB,EAASiB,MACpCT,EAAUG,IAAIK,GACd,IAAIE,EAAY,IAAIlB,EAASmB,SAASb,EAAQO,OAAO,uBASrD,SAASO,IACLJ,EAAiBK,QACjBL,EAAiBN,WAAW,QAC5B,IAAIY,EAASjB,EAAOkB,SACpB,GAAe,OAAXD,EAAJ,CAGA,IAAIE,EAAUnB,EAAOmB,QAAQF,EAAOG,MACpC,QAAgBC,IAAZF,GAAyBA,EAAQG,OAAS,EAAG,CAC7CX,EAAiBN,WAAW,SAC5B,IAAK,IAAIkB,EAAI,EAAGA,EAAIJ,EAAQG,OAAQC,KAC/B,SAAUN,EAAQO,GACf,IAAIC,EAAO,IAAI9B,EAAS+B,QAAQF,EAAOC,MAAME,SAAS,SAASC,YAAY,QAC3EH,EAAKI,SAAS,WACV7B,EAAO8B,QAAQ,IAAIjC,EAAsBG,EAAQA,EAAOkB,SAAUM,EAAQ,OAAQO,KAAKC,eAE3FrB,EAAiBL,IAAImB,GACrB,IAAIQ,EAAO,IAAItC,EAASmB,SAASb,EAAQO,OAAO,wBAChDyB,EAAKC,cAAc,OACnBD,EAAKE,QAAQ,WACTjC,EAAQkC,WAAWC,SAASpB,EAAQO,KAExCb,EAAiBL,IAAI2B,GACrB,IAAIK,EAAS,IAAI3C,EAASmB,SAASb,EAAQO,OAAO,0BAClD8B,EAAOJ,cAAc,OACrBI,EAAOH,QAAQ,WACPI,QAAQ,kBACRvC,EAAO8B,QAAQ,IAAIhC,EAAoBE,EAAQA,EAAOkB,SAAUM,MAGxEb,EAAiBL,IAAIgC,GACrB3B,EAAiBL,IAAI,IAAIX,EAASe,SApBtC,CAqBEO,EAAQE,EAAQI,MAe9B,OAvDAV,EAAUsB,QAAQ,WAKdnC,EAAO8B,QAAQ,IAAIlC,EAAiBI,EAAQA,EAAOkB,UAH/CO,KAAM,GACNe,OAAQ,mCAIhBrC,EAAUG,IAAIO,GAqCdX,EAAQuC,eAAenC,IAAI,SAAUW,GAClB,OAAXA,GAAmBjB,EAAO0C,SAAWzB,GACrCd,EAAUE,WAAW,SACrBU,KAEAZ,EAAUE,WAAW,UAG7BH,EAAQyC,YAAYrC,IAAIS,GACxBb,EAAQ0C,cAActC,IAAIS,GAC1Bb,EAAQ2C,cAAcvC,IAAIS,GACnBZ","file":"../../sideitems/Script.js","sourcesContent":["define([\n    'skylark-mrdoobui',\n    '../commands/AddScriptCommand',\n    '../commands/SetScriptValueCommand',\n    '../commands/RemoveScriptCommand'\n], function (mrdoobui, AddScriptCommand, SetScriptValueCommand, RemoveScriptCommand) {\n    'use strict';\n    var SidebarScript = function (editor) {\n        var strings = editor.strings;\n        var signals = editor.signals;\n        var container = new mrdoobui.UIPanel();\n        container.setDisplay('none');\n        container.add(new mrdoobui.UIText(strings.getKey('sidebar/script')).setTextTransform('uppercase'));\n        container.add(new mrdoobui.UIBreak());\n        container.add(new mrdoobui.UIBreak());\n        var scriptsContainer = new mrdoobui.UIRow();\n        container.add(scriptsContainer);\n        var newScript = new mrdoobui.UIButton(strings.getKey('sidebar/script/new'));\n        newScript.onClick(function () {\n            var script = {\n                name: '',\n                source: 'function update( event ) {}'\n            };\n            editor.execute(new AddScriptCommand(editor, editor.selected, script));\n        });\n        container.add(newScript);\n        function update() {\n            scriptsContainer.clear();\n            scriptsContainer.setDisplay('none');\n            var object = editor.selected;\n            if (object === null) {\n                return;\n            }\n            var scripts = editor.scripts[object.uuid];\n            if (scripts !== undefined && scripts.length > 0) {\n                scriptsContainer.setDisplay('block');\n                for (var i = 0; i < scripts.length; i++) {\n                    (function (object, script) {\n                        var name = new mrdoobui.UIInput(script.name).setWidth('130px').setFontSize('12px');\n                        name.onChange(function () {\n                            editor.execute(new SetScriptValueCommand(editor, editor.selected, script, 'name', this.getValue()));\n                        });\n                        scriptsContainer.add(name);\n                        var edit = new mrdoobui.UIButton(strings.getKey('sidebar/script/edit'));\n                        edit.setMarginLeft('4px');\n                        edit.onClick(function () {\n                            signals.editScript.dispatch(object, script);\n                        });\n                        scriptsContainer.add(edit);\n                        var remove = new mrdoobui.UIButton(strings.getKey('sidebar/script/remove'));\n                        remove.setMarginLeft('4px');\n                        remove.onClick(function () {\n                            if (confirm('Are you sure?')) {\n                                editor.execute(new RemoveScriptCommand(editor, editor.selected, script));\n                            }\n                        });\n                        scriptsContainer.add(remove);\n                        scriptsContainer.add(new mrdoobui.UIBreak());\n                    }(object, scripts[i]));\n                }\n            }\n        }\n        signals.objectSelected.add(function (object) {\n            if (object !== null && editor.camera !== object) {\n                container.setDisplay('block');\n                update();\n            } else {\n                container.setDisplay('none');\n            }\n        });\n        signals.scriptAdded.add(update);\n        signals.scriptRemoved.add(update);\n        signals.scriptChanged.add(update);\n        return container;\n    };\n    return { SidebarScript };\n});"]}