/**
 * skylark-threejs-editor - A version of threejs-editor that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-threejs-editor/
 * @license MIT
 */
define(["skylark-mrdoobui","../commands/AddObjectCommand","../commands/RemoveObjectCommand","../commands/MultiCmdsCommand","../commands/SetMaterialValueCommand"],function(e,n,t,a,s){"use strict";return function(o){var r=o.strings,i=new e.UIPanel;i.setClass("menu");var d=new e.UIPanel;d.setClass("title"),d.setTextContent(r.getKey("menubar/edit")),i.add(d);var l=new e.UIPanel;l.setClass("options"),i.add(l);var c=new e.UIRow;c.setClass("option"),c.setTextContent(r.getKey("menubar/edit/undo")),c.onClick(function(){o.undo()}),l.add(c);var u,m=new e.UIRow;m.setClass("option"),m.setTextContent(r.getKey("menubar/edit/redo")),m.onClick(function(){o.redo()}),l.add(m),(u=new e.UIRow).setClass("option"),u.setTextContent(r.getKey("menubar/edit/clear_history")),u.onClick(function(){confirm("The Undo/Redo History will be cleared. Are you sure?")&&o.history.clear()}),l.add(u),o.signals.historyChanged.add(function(){var e=o.history;c.setClass("option"),m.setClass("option"),0==e.undos.length&&c.setClass("inactive"),0==e.redos.length&&m.setClass("inactive")}),l.add(new e.UIHorizontalRule),(u=new e.UIRow).setClass("option"),u.setTextContent(r.getKey("menubar/edit/clone")),u.onClick(function(){var e=o.selected;null!==e.parent&&(e=e.clone(),o.execute(new n(o,e)))}),l.add(u),(u=new e.UIRow).setClass("option"),u.setTextContent(r.getKey("menubar/edit/delete")),u.onClick(function(){var e=o.selected;null!==e&&null!==e.parent&&o.execute(new t(o,e))}),l.add(u),(u=new e.UIRow).setClass("option"),u.setTextContent(r.getKey("menubar/edit/minify_shaders")),u.onClick(function(){var e=[],n=0,t=[];function r(e){t.length=0;var n=e.parent;return void 0!==n&&r(n),t.push(e.name||e.uuid),t}var i=[];(o.selected||o.scene).traverse(function(t){var a=t.material;if(void 0!==a&&a.isShaderMaterial)try{var d=glslprep.minifyGlsl([a.vertexShader,a.fragmentShader]);i.push(new s(o,t,"vertexShader",d[0])),i.push(new s(o,t,"fragmentShader",d[1])),++n}catch(n){var l=r(t).join("/");n instanceof glslprep.SyntaxError?e.push(l+":"+n.line+":"+n.column+": "+n.message):(e.push(l+": Unexpected error (see console for details)."),console.error(n.stack||n))}}),n>0&&o.execute(new a(o,i),"Minify Shaders"),window.alert(n+" material(s) were changed.\n"+e.join("\n"))}),l.add(u),l.add(new e.UIHorizontalRule),(u=new e.UIRow).setClass("option"),u.setTextContent(r.getKey("menubar/edit/fixcolormaps")),u.onClick(function(){o.scene.traverse(p)}),l.add(u);var C=["map","envMap","emissiveMap"];function p(e){var n=e.material;if(void 0!==n){if(!0===Array.isArray(n))for(var t=0;t<n.length;t++)v(n[t]);else v(n);o.signals.sceneGraphChanged.dispatch()}}function v(e){for(var n=e.needsUpdate,t=0;t<C.length;t++){var a=e[C[t]];a&&(a.encoding=THREE.sRGBEncoding,n=!0)}e.needsUpdate=n}return i}});
//# sourceMappingURL=../sourcemaps/menuitems/Edit.js.map
